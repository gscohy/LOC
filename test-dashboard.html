<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Tableau de Bord</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #f5f5f5;
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            background: white; 
            padding: 30px; 
            border-radius: 10px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .card {
            background: white;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            margin-bottom: 20px;
        }
        .card-header {
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
        }
        .card-content {
            padding: 20px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: white;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            padding: 20px;
            text-align: center;
        }
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #1f2937;
        }
        .stat-label {
            color: #6b7280;
            font-size: 0.875rem;
            margin-top: 5px;
        }
        .table-container {
            overflow-x: auto;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px;
            text-align: center;
            border-right: 1px solid #e5e7eb;
            font-size: 0.875rem;
        }
        th {
            background: #f9fafb;
            font-weight: 600;
            color: #374151;
        }
        .address-col {
            text-align: left;
            max-width: 200px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            position: sticky;
            left: 0;
            background: white;
            z-index: 10;
        }
        .positive { background: #dcfce7; color: #166534; }
        .negative { background: #fecaca; color: #dc2626; }
        .zero { background: #f3f4f6; color: #6b7280; }
        .chart-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .simple-bar-chart {
            display: flex;
            align-items: end;
            height: 200px;
            gap: 10px;
            padding: 20px;
        }
        .bar-group {
            flex: 1;
            display: flex;
            align-items: end;
            gap: 2px;
        }
        .bar {
            width: 20px;
            min-height: 5px;
            border-radius: 2px 2px 0 0;
        }
        .bar.revenus { background: #10b981; }
        .bar.charges { background: #ef4444; }
        .month-label {
            text-align: center;
            font-size: 0.75rem;
            color: #6b7280;
            margin-top: 5px;
        }
        .filter-section {
            background: #f9fafb;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        select, input {
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            margin: 0 10px;
        }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 0 5px;
        }
        button:hover {
            background: #2563eb;
        }
        .alert {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            color: #92400e;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üè¢ Tableau de Bord Financier - Test</h1>
        
        <div class="alert">
            üìä Cette page simule le nouveau tableau de bord avec graphiques et filtrage par propri√©taire
        </div>

        <!-- Statistiques -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value">5</div>
                <div class="stat-label">Propri√©taires</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">12</div>
                <div class="stat-label">Biens</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">15 420‚Ç¨</div>
                <div class="stat-label">Revenus Mensuel</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">3 580‚Ç¨</div>
                <div class="stat-label">Charges</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">11 840‚Ç¨</div>
                <div class="stat-label">B√©n√©fice Net</div>
            </div>
        </div>

        <!-- Graphiques -->
        <div class="chart-container">
            <div class="card">
                <div class="card-header">
                    <h3>Revenus vs Charges par Mois</h3>
                </div>
                <div class="card-content">
                    <div class="simple-bar-chart">
                        <div class="bar-group">
                            <div class="bar revenus" style="height: 80px;" title="Revenus Jan: 1200‚Ç¨"></div>
                            <div class="bar charges" style="height: 30px;" title="Charges Jan: 300‚Ç¨"></div>
                            <div class="month-label">Jan</div>
                        </div>
                        <div class="bar-group">
                            <div class="bar revenus" style="height: 85px;"></div>
                            <div class="bar charges" style="height: 35px;"></div>
                            <div class="month-label">F√©v</div>
                        </div>
                        <div class="bar-group">
                            <div class="bar revenus" style="height: 90px;"></div>
                            <div class="bar charges" style="height: 40px;"></div>
                            <div class="month-label">Mar</div>
                        </div>
                        <div class="bar-group">
                            <div class="bar revenus" style="height: 95px;"></div>
                            <div class="bar charges" style="height: 25px;"></div>
                            <div class="month-label">Avr</div>
                        </div>
                        <div class="bar-group">
                            <div class="bar revenus" style="height: 88px;"></div>
                            <div class="bar charges" style="height: 45px;"></div>
                            <div class="month-label">Mai</div>
                        </div>
                        <div class="bar-group">
                            <div class="bar revenus" style="height: 92px;"></div>
                            <div class="bar charges" style="height: 50px;"></div>
                            <div class="month-label">Jun</div>
                        </div>
                    </div>
                    <div style="display: flex; justify-content: center; gap: 20px; margin-top: 10px;">
                        <div style="display: flex; align-items: center; gap: 5px;">
                            <div style="width: 15px; height: 15px; background: #10b981; border-radius: 2px;"></div>
                            <span style="font-size: 0.875rem;">Revenus</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 5px;">
                            <div style="width: 15px; height: 15px; background: #ef4444; border-radius: 2px;"></div>
                            <span style="font-size: 0.875rem;">Charges</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3>R√©partition des Charges</h3>
                </div>
                <div class="card-content">
                    <div style="space-y: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div style="width: 15px; height: 15px; background: #3b82f6; border-radius: 2px;"></div>
                                <span>Travaux</span>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-weight: 600;">45.2%</div>
                                <div style="font-size: 0.75rem; color: #6b7280;">1 618‚Ç¨</div>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div style="width: 15px; height: 15px; background: #10b981; border-radius: 2px;"></div>
                                <span>Entretien</span>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-weight: 600;">28.7%</div>
                                <div style="font-size: 0.75rem; color: #6b7280;">1 027‚Ç¨</div>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div style="width: 15px; height: 15px; background: #f59e0b; border-radius: 2px;"></div>
                                <span>Charges</span>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-weight: 600;">26.1%</div>
                                <div style="font-size: 0.75rem; color: #6b7280;">935‚Ç¨</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filtres -->
        <div class="filter-section">
            <h3>Filtres</h3>
            <div style="display: flex; align-items: center; flex-wrap: wrap; gap: 10px;">
                <label>Propri√©taire:</label>
                <select id="proprietaire">
                    <option value="">Tous les propri√©taires</option>
                    <option value="1">Jean Dupont</option>
                    <option value="2">Marie Martin</option>
                    <option value="3">Pierre Durand</option>
                </select>
                
                <label>Ann√©e:</label>
                <select id="annee">
                    <option value="2024">2024</option>
                    <option value="2023">2023</option>
                    <option value="2022">2022</option>
                </select>
                
                <button onclick="applyFilters()">üîç Appliquer</button>
                <button onclick="exportData()">üìä Export CSV</button>
            </div>
        </div>

        <!-- Tableau de synth√®se financi√®re -->
        <div class="card">
            <div class="card-header">
                <h3>üìã Synth√®se Financi√®re par Bien - 2024</h3>
                <p style="color: #6b7280; font-size: 0.875rem; margin-top: 5px;">
                    Revenus - Charges par mois et par bien
                </p>
            </div>
            <div class="card-content">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="address-col">Adresse</th>
                                <th>Jan</th>
                                <th>F√©v</th>
                                <th>Mar</th>
                                <th>Avr</th>
                                <th>Mai</th>
                                <th>Jun</th>
                                <th>Jul</th>
                                <th>Ao√ª</th>
                                <th>Sep</th>
                                <th>Oct</th>
                                <th>Nov</th>
                                <th>D√©c</th>
                                <th>Total</th>
                                <th>Diff</th>
                            </tr>
                        </thead>
                        <tbody id="financialTable">
                            <!-- Sera rempli par JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Totaux -->
                <div style="background: #f9fafb; padding: 20px; margin-top: 20px; border-radius: 8px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div>
                            <span style="color: #6b7280;">Total Revenus: </span>
                            <span style="font-weight: 600; color: #059669;">185 040‚Ç¨</span>
                        </div>
                        <div>
                            <span style="color: #6b7280;">Total Charges: </span>
                            <span style="font-weight: 600; color: #dc2626;">42 960‚Ç¨</span>
                        </div>
                        <div>
                            <span style="color: #6b7280;">B√©n√©fice Net: </span>
                            <span style="font-weight: 600; color: #2563eb;">142 080‚Ç¨</span>
                        </div>
                        <div>
                            <span style="color: #6b7280;">Nombre de biens: </span>
                            <span style="font-weight: 600;">12</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Donn√©es simul√©es
        const biens = [
            { adresse: "17 Bis rue Jean-Jacques Rousseau", data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -4270] },
            { adresse: "26 rue du moulin", data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2345] },
            { adresse: "32 rue du moulin", data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] },
            { adresse: "8 Rue du 11 Novembre", data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -4130] },
            { adresse: "3 place Jean Jaures", data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -4760] },
            { adresse: "37 rue Chisholm", data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -6095] },
            { adresse: "2 Rue de Corcy", data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -4550] },
            { adresse: "17 rue Jean-Jacques Rousseau", data: [0, 0, 0, 560, 0, 0, 0, 0, 0, 0, 0, 560, -3360] },
            { adresse: "35 Rue Chisholm", data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -3920] }
        ];

        function getCellClass(value) {
            if (value > 0) return 'positive';
            if (value < 0) return 'negative';
            return 'zero';
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('fr-FR', {
                style: 'currency',
                currency: 'EUR',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function renderTable() {
            const tbody = document.getElementById('financialTable');
            tbody.innerHTML = '';

            biens.forEach((bien, index) => {
                const row = document.createElement('tr');
                row.style.backgroundColor = index % 2 === 0 ? 'white' : '#f9fafb';
                
                let html = `<td class="address-col" title="${bien.adresse}">${bien.adresse}</td>`;
                
                // Ajouter les 12 mois
                for (let i = 0; i < 12; i++) {
                    const value = bien.data[i];
                    html += `<td class="${getCellClass(value)}">${formatCurrency(value)}</td>`;
                }
                
                // Total et diff√©rence
                const total = bien.data[12];
                html += `<td class="${getCellClass(total)}" style="font-weight: bold;">${formatCurrency(total)}</td>`;
                html += `<td class="${getCellClass(total)}" style="font-weight: bold;">${formatCurrency(total)}</td>`;
                
                row.innerHTML = html;
                tbody.appendChild(row);
            });
        }

        function applyFilters() {
            const proprietaire = document.getElementById('proprietaire').value;
            const annee = document.getElementById('annee').value;
            
            console.log('Filtres appliqu√©s:', { proprietaire, annee });
            
            // Simuler le rechargement des donn√©es
            renderTable();
            
            // Afficher un message
            alert(`Filtres appliqu√©s:\nPropri√©taire: ${proprietaire || 'Tous'}\nAnn√©e: ${annee}`);
        }

        function exportData() {
            // Simuler l'export CSV
            let csv = 'Adresse,Jan,F√©v,Mar,Avr,Mai,Jun,Jul,Ao√ª,Sep,Oct,Nov,D√©c,Total,Diff\n';
            
            biens.forEach(bien => {
                csv += `"${bien.adresse}",`;
                csv += bien.data.slice(0, 12).join(',') + ',';
                csv += bien.data[12] + ',' + bien.data[12] + '\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'synthese-financiere-2024.csv';
            a.click();
            URL.revokeObjectURL(url);
            
            console.log('Export CSV g√©n√©r√©');
        }

        // Initialiser le tableau
        renderTable();

        console.log('‚úÖ Tableau de bord de test initialis√©');
        console.log('üéØ Fonctionnalit√©s disponibles:');
        console.log('- Statistiques financi√®res');
        console.log('- Graphiques revenus/charges');
        console.log('- Tableau filtrable par propri√©taire');
        console.log('- Export CSV');
    </script>
</body>
</html>